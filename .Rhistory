<<<<<<< Updated upstream
<<<<<<< HEAD
coord_flip() +
ggtitle("Gennemsnitligt antal ansøgere")
ggplot(data4, aes(x=InstNavn, y=GnsTotalAng)) +
geom_bar(stat="identity", fill="#53cfff") +
#geom_text(aes(x=InstNavn, y=TotalOpt), size=4) +
theme_light(base_size=15) +
#theme(axis.text.y = element_text(hjust=0, color="black"), axis.text.x=element_blank()) +
xlab("") +
coord_flip() +
ggtitle("Gennemsnitligt antal ansøgere")
ggplot(data4, aes(x=InstNavn, y=GnsTotalAng)) +
geom_bar(stat="identity", fill="#53cfff") +
#geom_text(aes(x=InstNavn, y=TotalOpt), size=4) +
theme_light(base_size=10) +
#theme(axis.text.y = element_text(hjust=0, color="black"), axis.text.x=element_blank()) +
xlab("") +
coord_flip() +
ggtitle("Gennemsnitligt antal ansøgere")
ggplot(data4, aes(x=InstNavn, y=GnsTotalAng)) +
geom_bar(stat="identity", fill="#53cfff") +
#geom_text(aes(x=InstNavn, y=TotalOpt), size=4) +
theme_light(base_size=16) +
#theme(axis.text.y = element_text(hjust=0, color="black"), axis.text.x=element_blank()) +
xlab("") +
coord_flip() +
ggtitle("Gennemsnitligt antal ansøgere")
ggplot(data4, aes(x=InstNavn, y=GnsTotalAng)) +
geom_bar(stat="identity", fill="#53cfff") +
geom_text(aes(x=College, y=GnsTotalAng, ymax=GnsTotalAng, hjust=1, label=GnsTotalAng), size=4) +
theme_light(base_size=16) +
#theme(axis.text.y = element_text(hjust=0, color="black"), axis.text.x=element_blank()) +
xlab("") +
coord_flip() +
ggtitle("Gennemsnitligt antal ansøgere")
ggplot(data4, aes(x=InstNavn, y=GnsTotalAng)) +
geom_bar(stat="identity", fill="#53cfff") +
geom_text(aes(x=InstNavn, y=GnsTotalAng, ymax=GnsTotalAng, hjust=1, label=GnsTotalAng), size=4) +
theme_light(base_size=16) +
#theme(axis.text.y = element_text(hjust=0, color="black"), axis.text.x=element_blank()) +
coord_flip() +
xlab("") +
ggtitle("Gennemsnitligt antal ansøgere")
ggplot(data4, aes(x=InstNavn, y=GnsTotalAng)) +
geom_bar(stat="identity", fill="#53cfff", position="dodge") +
geom_text(aes(x=InstNavn, y=GnsTotalAng, ymax=GnsTotalAng, hjust=1, label=GnsTotalAng), size=4) +
theme_light(base_size=16) +
#theme(axis.text.y = element_text(hjust=0, color="black"), axis.text.x=element_blank()) +
xlab("") +
coord_flip() +
ggtitle("Gennemsnitligt antal ansøgere")
ggplot(data4, aes(x=InstNavn)) +
geom_bar(stat="identity", fill="#53cfff", position="dodge") +
geom_text(aes(x=InstNavn, y=GnsTotalAng, ymax=GnsTotalAng, hjust=1, label=GnsTotalAng), size=4) +
theme_light(base_size=16) +
#theme(axis.text.y = element_text(hjust=0, color="black"), axis.text.x=element_blank()) +
xlab("") +
coord_flip() +
ggtitle("Gennemsnitligt antal ansøgere")
ggplot(data4, aes(x=InstNavn, y=GnsTotalAng)) +
geom_bar(stat="identity", fill="#53cfff", position="dodge") +
geom_text(aes(x=InstNavn, y=GnsTotalAng, ymax=GnsTotalAng, hjust=1, label=GnsTotalAng), size=4) +
theme_light(base_size=16) +
#theme(axis.text.y = element_text(hjust=0, color="black"), axis.text.x=element_blank()) +
xlab("") +
coord_flip() +
ggtitle("Gennemsnitligt antal ansøgere")
View(data4)
View(data4)
data5 = data2 %>%
group_by(InstNavn) %>%
summarise( GnsAngM = sum(AngMaend, na.rm=TRUE)/4,
GnsAngK = sum(AngKvinder, na.rm=TRUE)/4)
View(data5)
138+171
data5 = data2 %>%
group_by(InstNavn) %>%
summarise( GnsAngM = round(sum(AngMaend, na.rm=TRUE)/4,0),
GnsAngK = round(sum(AngKvinder, na.rm=TRUE)/4, 0))
View(data5)
data6 = data.frame(
InstNavn = c(rep("Arkitektskolen", 2), rep("AU", 2), rep("CBS", 2), rep("Designskolen",2))
)
View(data6)
data6 = data.frame(
InstNavn = c(rep("Arkitektskolen", 2), rep("AU", 2), rep("CBS", 2), rep("Designskolen",2),
rep("Det Kongelige Danske Kunstakademi", 2), rep("DTU", 2),
rep("ITU", 2), rep("KU", 2), rep("RUC", 2), rep("SDU", 2), rep("AAU", 2)),
InstNavn1 = c(rep(data5$InstNavn,2))
)
View(data6)
data6 = data.frame(
InstNavn = c(rep("Arkitektskolen", 2), rep("AU", 2), rep("CBS", 2), rep("Designskolen",2),
rep("Det Kongelige Danske Kunstakademi", 2), rep("DTU", 2),
rep("ITU", 2), rep("KU", 2), rep("RUC", 2), rep("SDU", 2), rep("AAU", 2)),
InstNavn1 = c(data5$InstNavn, data5$InstNavn)
)
View(data6)
data6 = data.frame(
InstNavn = c(rep("Arkitektskolen", 2), rep("AU", 2), rep("CBS", 2), rep("Designskolen",2),
rep("Det Kongelige Danske Kunstakademi", 2), rep("DTU", 2),
rep("ITU", 2), rep("KU", 2), rep("RUC", 2), rep("SDU", 2), rep("AAU", 2)),
GnsAng = c(139, 172, 3780, 4542, 2686, 2395, 57, 193, 520, 970, 927, 394, 357, 99,
4642, 7332, 722, 1078, 2546, 2934, 2593, 2355),
Sex = c(rep("M,K",11))
)
View(data6)
data6 = data.frame(
InstNavn = c(rep("Arkitektskolen", 2), rep("AU", 2), rep("CBS", 2), rep("Designskolen",2),
rep("Det Kongelige Danske Kunstakademi", 2), rep("DTU", 2),
rep("ITU", 2), rep("KU", 2), rep("RUC", 2), rep("SDU", 2), rep("AAU", 2)),
GnsAng = c(139, 172, 3780, 4542, 2686, 2395, 57, 193, 520, 970, 927, 394, 357, 99,
4642, 7332, 722, 1078, 2546, 2934, 2593, 2355),
Sex = c(rep("M","K",11))
)
data6 = data.frame(
InstNavn = c(rep("Arkitektskolen", 2), rep("AU", 2), rep("CBS", 2), rep("Designskolen",2),
rep("Det Kongelige Danske Kunstakademi", 2), rep("DTU", 2),
rep("ITU", 2), rep("KU", 2), rep("RUC", 2), rep("SDU", 2), rep("AAU", 2)),
GnsAng = c(139, 172, 3780, 4542, 2686, 2395, 57, 193, 520, 970, 927, 394, 357, 99,
4642, 7332, 722, 1078, 2546, 2934, 2593, 2355),
Sex = c(rep(("M","K"),11))
)
View(data6)
?rep
data6 = data.frame(
InstNavn = c(rep("Arkitektskolen", 2), rep("AU", 2), rep("CBS", 2), rep("Designskolen",2),
rep("Det Kongelige Danske Kunstakademi", 2), rep("DTU", 2),
rep("ITU", 2), rep("KU", 2), rep("RUC", 2), rep("SDU", 2), rep("AAU", 2)),
GnsAng = c(139, 172, 3780, 4542, 2686, 2395, 57, 193, 520, 970, 927, 394, 357, 99,
4642, 7332, 722, 1078, 2546, 2934, 2593, 2355),
Sex = c(rep(c("M","K"), 11))
)
View(data6)
ggplot(data=data6, aes(x=InstNavn, y=GnsAng, fill=Sex)) +
geom_bar(stat="identity")
ggplot(data=data6, aes(x=InstNavn, y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip()
View(data6)
ggplot(data=data6, aes(x=InstNavn, y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total")
ggplot(data=data6, aes(x=InstNavn, y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("")
data7 = cbind(Rank=1:nrow(data6), data6)
View(data7)
data3 %>%
ggvis(~Aar, ~TotalKviOpt, stroke = ~factor(Retning)) %>%
layer_lines
data7 = data6 %>%
arrange(desc(GnsAng))
View(data7)
ggplot(data=data7, aes(x=InstNavn, y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("")
data7 = data6 %>%
arrange("Designskolen", "Arkitektskolen", "ITU", "DTU", "Det Kongelige Danske Kunstakademi",
"RUC", "AAU", "CBS", "SDU", "AU", "KU")
data6 = data.frame(
InstNavn = c(rep("Designskolen", 2), rep("Arkitektskolen", 2), rep("ITU", 2), rep("DTU",2),
rep("Det Kongelige Danske Kunstakademi", 2), rep("RUC", 2),
rep("AAU", 2), rep("CBS", 2), rep("SDU", 2), rep("AU", 2), rep("KU", 2)),
GnsAng = c(57, 193, 138, 172, 357, 99, 927, 394, 520, 970, 722, 1078, 2593, 2355, 2686, 2395,
2546, 2934, 3780, 4542, 4642, 7332),
Sex = c(rep(c("M","K"), 11))
)
View(data6)
ggplot(data=data6, aes(x=InstNavn, y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("")
data6 = data.frame(
InstNavn = c(rep("Designskolen", 2), rep("Arkitektskolen", 2), rep("ITU", 2), rep("DTU",2),
rep("Det Kongelige Danske Kunstakademi", 2), rep("RUC", 2),
rep("AAU", 2), rep("CBS", 2), rep("SDU", 2), rep("AU", 2), rep("KU", 2)),
GnsAng = c(57, 193, 138, 172, 357, 99, 927, 394, 520, 970, 722, 1078, 2593, 2355, 2686, 2395,
2546, 2934, 3780, 4542, 4642, 7332),
Sex = c(rep(c("M","K"), 11))
)
ggplot(data=data6, aes(x=InstNavn, y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("")
ggplot(data=data6, aes(x=InstNavn, y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("") +
opts(axis.text.y=theme_text(angle=90))
??opts
library("knitr")
ggplot(data=data6, aes(x=InstNavn, y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("") +
opts(axis.text.y=theme_text(angle=90))
??melt
data7 = melt(data6, id(c("InstNavn")))
install.packages("reshape")
library("reshape")
data7 = melt(data6, id(c("InstNavn")))
View(data7)
View(data7)
View(data7)
ggplot(data7, aes(x = InstNavn, y = value, fill=variable)) +
geom_bar() + coord_flip()
ggplot(data=data6, aes(x=InstNavn, y=GnsAng, fill=Sex)) +
geom_bar(stat="identity", aes(weights=GnsAng)) +
coord_flip() + ylab("Total") + xlab("")
ggplot(data=data6, aes(x=InstNavn, y=GnsAng, fill=Sex)) +
geom_bar(aes(weights=GnsAng)) +
coord_flip() + ylab("Total") + xlab("")
ggplot(data=data6, aes(x=InstNavn, y=GnsAng, fill=Sex)) +
geom_bar(aes(weights=GnsAng), position="dodge") +
coord_flip() + ylab("Total") + xlab("")
ggplot(data=data6, aes(x=InstNavn, y=GnsAng, fill=Sex)) +
geom_bar(aes(weights=GnsAng), position="dodge") +
coord_flip() + ylab("Total") + xlab("")
ggplot(data=data6, aes(x=InstNavn, y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("")
ggplot(data=data6, aes(x=InstNavn, y=GnsAng, fill=Sex, order=GnsAng)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("")
ggplot(data=data6, aes(x=InstNavn, y=GnsAng, fill=Sex, order=as.factor(GnsAng))) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("")
ggplot(data=data6, aes(x=InstNavn, y=GnsAng, fill=Sex, order=GnsAng)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("")
ggplot(data=data6, aes(x=InstNavn, y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("")
ggplot(data=data6, aes(x=InstNavn, y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("")
ggplot(data=data6, aes(x=InstNavn, y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("")
data6$InstNavn = reorder(data6$InstNavn, rowSums(data6[-1]))
data6 = within(data6, Position=factor(Position, levels=names(sort(table(Position), decreasing=TRUE))))
data6 <- within(data6, InstNavn <- factor(InstNavn,
levels=names(sort(table(InstNavn), decreasing=TRUE))))
View(data6)
ggplot(data=data6, aes(x=InstNavn, y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("")
data6 <- within(data6, InstNavn <- factor(InstNavn,
levels=names(sort(table(InstNavn), decreasing=FALSE))))
View(data6)
data6 <- within(data6, InstNavn <- levels=names(sort(table(InstNavn), decreasing=FALSE))))
data6 <- within(data6, levels=names(sort(table(InstNavn), decreasing=FALSE))))
ggplot(data=data6, aes(x=reorder(InstNavn, -Count), y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("")
ggplot(data=data6, aes(x=reorder(InstNavn, -GnsAng), y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("")
ggplot(data=data6, aes(x=reorder(InstNavn, GnsAng), y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("")
ggplot(data3, aes(Aar, TotalKviOpt, color = Retning)) +
geom_line()
View(data2)
datatop10 = data2 %>%
arrange(AngKvinder)
View(datatop10)
datatop10 = data2 %>%
arrange(-AngKvinder)
View(datatop10)
datatop10 = data2 %>%
arrange(-AngKvinder) %>%
filter(AngKvinder > 800)
View(datatop10)
datatop10 = data2 %>%
group_by(Aar)
arrange(-AngKvinder) %>%
filter(AngKvinder > 800) %>%
select(InstNavn, AngKvinder, AngMaend, )
datatop10 = data2 %>%
group_by(Aar)
arrange(-AngKvinder)
datatop10 = data2 %>%
group_by(Aar)
arrange(-AngKvinder) %>%
filter(AngKvinder > 800)
datatop10 = data2 %>%
group_by(Aar, AngKvinder)
arrange(-AngKvinder) %>%
filter(AngKvinder > 800)
View(data2)
datatop10 = data2 %>%
arrange(-AngKvinder) %>%
filter(AngKvinder > 800)
datatop10 = data2 %>%
filter(Aar == "2016", AngKvinder > 800) %>%
arrange(-AngKvinder)
View(datatop10)
datatop10 = data2 %>%
filter(Aar == "2016") %>%
arrange(-AngKvinder)
View(datatop10)
datatop10 = data2 %>%
filter(Aar == "2016", AngKvinder > 400) %>%
arrange(-AngKvinder)
View(datatop10)
datatopK = data2 %>%
filter(Aar == "2016", AngKvinder > 400) %>%
arrange(-AngKvinder)
dataTopM = data2 %>%
filter(Aar == "2016") %>%
arrange(-AngMaend)
View(dataTopM)
dataTopM = data2 %>%
filter(Aar == "2016", AngMaend > 250) %>%
arrange(-AngMaend)
View(dataTopM)
View(datatopK)
ggplot(data = dataTopK, aes(x = Uddannelse, y = AngKvinder)) +
geom_bar()
dataTopK = data2 %>%
filter(Aar == "2016", AngKvinder > 400) %>%
arrange(-AngKvinder)
ggplot(data = dataTopK, aes(x = Uddannelse, y = AngKvinder)) +
geom_bar()
ggplot(data = dataTopK, aes(x = Uddannelse, y = AngKvinder)) +
geom_bar(stat = "identity")
ggplot(data = dataTopK, aes(x = Uddannelse, y = AngKvinder)) +
geom_bar(stat = "identity") +
coord_flip
coord_flip()
ggplot(data = dataTopK, aes(x = Uddannelse, y = AngKvinder)) +
geom_bar(stat = "identity") +
coord_flip()
ggplot(data = dataTopK, aes(x = OptNavn, y = AngKvinder)) +
geom_bar(stat = "identity") +
coord_flip()
ggplot(data = dataTopK, aes(x = reorder(OptNavn, AngKvinder), y = AngKvinder)) +
geom_bar(stat = "identity") +
coord_flip()
ggplot(data = dataTopM, aes(x=reorder(OptNavn, AngMaend), y = AngMaend)) +
geom_bar(stat = "identity") +
coord_flip()
dataTop = data2 %>%
group_by(OptNavn) %>%
summarise(GnsAngM = round(sum(AngMaend, na.rm=TRUE)/4,0),
GnsAngK = round(sum(AngKvinder, na.rm=TRUE)/4, 0))
View(dataTop)
filter(Aar == "2016")
dataTop = data2 %>%
filter(Aar == "2016")
dataTop = data2 %>%
group_by(OptNavn, Aar) %>%
summarise(GnsAngM = round(sum(AngMaend, na.rm=TRUE)/4,0),
GnsAngK = round(sum(AngKvinder, na.rm=TRUE)/4, 0))
View(dataTop)
ggplot(data = dataTopK, aes(x = reorder(OptNavn, AngKvinder), y = AngKvinder)) +
geom_bar(stat = "identity", color="blue") +
coord_flip()
ggplot(data = dataTopK, aes(x = reorder(OptNavn, AngKvinder), y = AngKvinder)) +
geom_bar(stat = "identity", color="blue", fill="blue") +
coord_flip()
ggplot(data = dataTopK, aes(x = reorder(OptNavn, AngKvinder), y = AngKvinder)) +
geom_bar(stat = "identity", color="slateblue3", fill="slateblue3") +
coord_flip()
ggplot(data = dataTopK, aes(x = reorder(OptNavn, AngKvinder), y = AngKvinder)) +
geom_bar(stat = "identity", color="steelblue4", fill="steelblue4") +
coord_flip()
ggplot(data = dataTopK, aes(x = reorder(OptNavn, AngKvinder), y = AngKvinder)) +
geom_bar(stat = "identity", color="steelblue3", fill="steelblue3") +
coord_flip()
ggplot(data=data6, aes(x=reorder(InstNavn, GnsAng), y=GnsAng, fill=Sex)) +
geom_bar(stat="identity", color="steelblue3") +
coord_flip() + ylab("Total") + xlab("")
ggplot(data=data6, aes(x=reorder(InstNavn, GnsAng), y=GnsAng, fill=Sex)) +
geom_bar(stat="identity", color="steelblue3", fill="steelblue3") +
coord_flip() + ylab("Total") + xlab("")
ggplot(data=data6, aes(x=reorder(InstNavn, GnsAng), y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("")
ggplot(data=data6, aes(x=reorder(InstNavn, GnsAng), y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("") +
scale_fill_manual(values=c("steelblue3", "indianred4"))
ggplot(data=data6, aes(x=reorder(InstNavn, GnsAng), y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("") +
scale_fill_manual(values=c("steelblue3", "indianred3"))
ggplot(data=data6, aes(x=reorder(InstNavn, GnsAng), y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("") +
scale_fill_manual(values=c("steelblue3", "orangered1"))
scale_fill_manual(values=c("palegreen4", "orangered1"))
ggplot(data=data6, aes(x=reorder(InstNavn, GnsAng), y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("") +
scale_fill_manual(values=c("palegreen4", "orangered1"))
ggplot(data=data6, aes(x=reorder(InstNavn, GnsAng), y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("") +
scale_fill_manual(values=c("royalblue4", "orangered1"))
ggplot(data=data6, aes(x=reorder(InstNavn, GnsAng), y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("") +
scale_fill_manual(values=c("royalblue4", "royalblue3"))
ggplot(data=data6, aes(x=reorder(InstNavn, GnsAng), y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("") +
scale_fill_manual(values=c("royalblue2", "royalblue3"))
ggplot(data=data6, aes(x=reorder(InstNavn, GnsAng), y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("") +
scale_fill_manual(values=c("royalblue1", "royalblue3"))
ggplot(data=data6, aes(x=reorder(InstNavn, GnsAng), y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("") +
scale_fill_manual(values=c("royalblue2", "royalblue4"))
ggplot(data=data6, aes(x=reorder(InstNavn, GnsAng), y=GnsAng, fill=Sex)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("") +
scale_fill_manual(values=c("royalblue2", "royalblue4")) + # valgfrie farver se link: http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf
ggtitle("Fordeling af ansøgere")
data6 = data.frame(
InstNavn = c(rep("Designskolen", 2), rep("Arkitektskolen", 2), rep("ITU", 2), rep("DTU",2),
rep("Det Kongelige Danske Kunstakademi", 2), rep("RUC", 2),
rep("AAU", 2), rep("CBS", 2), rep("SDU", 2), rep("AU", 2), rep("KU", 2)),
GnsAng = c(57, 193, 138, 172, 357, 99, 927, 394, 520, 970, 722, 1078, 2593, 2355, 2686, 2395,
2546, 2934, 3780, 4542, 4642, 7332),
Køn = c(rep(c("Mand","Kvinde"), 11))
)
ggplot(data=data6, aes(x=reorder(InstNavn, GnsAng), y=GnsAng, fill=Sex)) +
data6 = data.frame(
InstNavn = c(rep("Designskolen", 2), rep("Arkitektskolen", 2), rep("ITU", 2), rep("DTU",2),
rep("Det Kongelige Danske Kunstakademi", 2), rep("RUC", 2),
rep("AAU", 2), rep("CBS", 2), rep("SDU", 2), rep("AU", 2), rep("KU", 2)),
GnsAng = c(57, 193, 138, 172, 357, 99, 927, 394, 520, 970, 722, 1078, 2593, 2355, 2686, 2395,
2546, 2934, 3780, 4542, 4642, 7332),
Køn = c(rep(c("Mand","Kvinde"), 11))
)
data6 = data.frame(
InstNavn = c(rep("Designskolen", 2), rep("Arkitektskolen", 2), rep("ITU", 2), rep("DTU",2),
rep("Det Kongelige Danske Kunstakademi", 2), rep("RUC", 2),
rep("AAU", 2), rep("CBS", 2), rep("SDU", 2), rep("AU", 2), rep("KU", 2)),
GnsAng = c(57, 193, 138, 172, 357, 99, 927, 394, 520, 970, 722, 1078, 2593, 2355, 2686, 2395,
2546, 2934, 3780, 4542, 4642, 7332),
Køn = c(rep(c("Mand","Kvinde"), 11))
)
View(data6)
data6 = data.frame(
InstNavn = c(rep("Designskolen", 2), rep("Arkitektskolen", 2), rep("ITU", 2), rep("DTU",2),
rep("Det Kongelige Danske Kunstakademi", 2), rep("RUC", 2),
rep("AAU", 2), rep("CBS", 2), rep("SDU", 2), rep("AU", 2), rep("KU", 2)),
GnsAng = c(57, 193, 138, 172, 357, 99, 927, 394, 520, 970, 722, 1078, 2593, 2355, 2686, 2395,
2546, 2934, 3780, 4542, 4642, 7332),
Koen = c(rep(c("Mand","Kvinde"), 11))
)
ggplot(data=data6, aes(x=reorder(InstNavn, GnsAng), y=GnsAng, fill=Koen)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Total") + xlab("") +
scale_fill_manual(values=c("royalblue2", "royalblue4")) + # valgfrie farver se link: http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf
ggtitle("Fordeling af ansøgere")
ggplot(data = dataTopK, aes(x = reorder(OptNavn, AngKvinder), y = AngKvinder)) +
geom_bar(stat = "identity", color="royalblue2", fill="royalblue2") +
coord_flip()
ggplot(data = dataTopM, aes(x=reorder(OptNavn, AngMaend), y = AngMaend)) +
geom_bar(stat = "identity", color = "royalblue4", fill="royalblue4") +
coord_flip()
ggplot(data = dataTopM, aes(x=reorder(OptNavn, AngMaend), y = AngMaend)) +
geom_bar(stat = "identity", color = "royalblue4", fill="royalblue4") +
coord_flip() +
xlab("Mandlige ansøgere") + ylab("")
ggplot(data = dataTopM, aes(x=reorder(OptNavn, AngMaend), y = AngMaend)) +
geom_bar(stat = "identity", color = "royalblue4", fill="royalblue4") +
coord_flip() +
ylab("Mandlige ansøgere") + xlab("")
ggplot(data = dataTopM, aes(x=reorder(OptNavn, AngMaend), y = AngMaend)) +
geom_bar(stat = "identity", color = "royalblue4", fill="royalblue4") +
coord_flip() + ggtitle("Top 10 uddannelser for mænd") +
ylab("Mandlige ansøgere") + xlab("")
ggplot(data = dataTopK, aes(x = reorder(OptNavn, AngKvinder), y = AngKvinder)) +
geom_bar(stat = "identity", color="royalblue2", fill="royalblue2") +
coord_flip() + ggtitle("Top 10 uddannelser for kvinder") +
ylab("Kvindelige ansøgere") + xlab("")
ggplot(data = dataTopK, aes(x = reorder(OptNavn, AngKvinder), y = AngKvinder)) +
geom_bar(stat = "identity", color="royalblue2", fill="royalblue2") +
coord_flip() + ggtitle("Top 10 uddannelser for kvinder") +
ylab("Ansøgere") + xlab("")
ggplot(data = dataTopM, aes(x=reorder(OptNavn, AngMaend), y = AngMaend)) +
geom_bar(stat = "identity", color = "royalblue4", fill="royalblue4") +
coord_flip() + ggtitle("Top 10 uddannelser for mænd") +
ylab("Ansøgere") + xlab("")
View(dataTopM)
ggplot(data = dataTopM, aes(x=reorder(OptNavn, AngMaend), y = AngMaend)) +
geom_bar(stat = "identity", color = Retning, fill="royalblue4") +
coord_flip() + ggtitle("Top 10 uddannelser for mænd") +
ylab("Ansøgere") + xlab("")
ggplot(data = dataTopM, aes(x=reorder(OptNavn, AngMaend), y = AngMaend)) +
geom_bar(stat = "identity", color = "Retning", fill="royalblue4") +
coord_flip() + ggtitle("Top 10 uddannelser for mænd") +
ylab("Ansøgere") + xlab("")
ggplot(data = dataTopM, aes(x=reorder(OptNavn, AngMaend), y = AngMaend)) +
geom_bar(stat = "identity", color = dataTopM$Retning, fill="royalblue4") +
coord_flip() + ggtitle("Top 10 uddannelser for mænd") +
ylab("Ansøgere") + xlab("")
ggplot(data = dataTopM, aes(x=reorder(OptNavn, AngMaend), y = AngMaend), fill = Retning) +
geom_bar(stat = "identity") +
coord_flip() + ggtitle("Top 10 uddannelser for mænd") +
ylab("Ansøgere") + xlab("")
ggplot(data = dataTopM, aes(x=reorder(OptNavn, AngMaend), y = AngMaend), color = Retning) +
geom_bar(stat = "identity") +
coord_flip() + ggtitle("Top 10 uddannelser for mænd") +
ylab("Ansøgere") + xlab("")
ggplot(data = dataTopM, aes(x=reorder(OptNavn, AngMaend), y = AngMaend)) +
geom_bar(stat = "identity", color = "royalblue4", fill="royalblue4") +
coord_flip() + ggtitle("Top 10 uddannelser for mænd") +
ylab("Ansøgere") + xlab("")
=======
gr = as.numeric(fxb)*(diag(k1) - as.numeric(xb) *(be %*% t(xm)))
mfx$se = sqrt(diag(gr %*% vcv %*% t(gr)))
} else {
gr = apply(x1, 1, function(x){
as.numeric(as.numeric(dnorm(x %*% be))*(diag(k1) - as.numeric(x %*% be)*(be %*% t(x))))
})
gr = matrix(apply(gr,1,mean),nrow=k1)
mfx$se = sqrt(diag(gr %*% vcv %*% t(gr)))
}
# pick out constant and remove from mfx table
temp1 = apply(x1,2,function(x)length(table(x))==1)
const = names(temp1[temp1==TRUE])
mfx = mfx[row.names(mfx)!=const,]
# pick out discrete change variables
temp1 = apply(x1,2,function(x)length(table(x))==2)
disch = names(temp1[temp1==TRUE])
# calculate the disctrete change marginal effects and standard errors
if(length(disch)!=0){
for(i in 1:length(disch)){
if(atmean){
disx0 = disx1 = xm
disx1[disch[i],] = max(x1[,disch[i]])
disx0[disch[i],] = min(x1[,disch[i]])
# mfx equal to    prediction @ x=1     minus prediction @ x=0
mfx[disch[i],1] = pnorm(t(be) %*% disx1) - pnorm(t(be) %*% disx0)
# standard errors
gr = dnorm(t(be) %*% disx1) %*% t(disx1) - dnorm(t(be) %*% disx0) %*% t(disx0)
mfx[disch[i],2] = sqrt(gr %*% vcv %*% t(gr))
} else {
disx0 = disx1 = x1
disx1[,disch[i]] = max(x1[,disch[i]])
disx0[,disch[i]] = min(x1[,disch[i]])
mfx[disch[i],1] = mean(pnorm(disx1 %*% be) - pnorm(disx0 %*% be))
# standard errors
gr = as.numeric(dnorm(disx1 %*% be)) * disx1 - as.numeric(dnorm(disx0 %*% be)) * disx0
avegr = as.matrix(colMeans(gr))
mfx[disch[i],2] = sqrt(t(avegr) %*% vcv %*% avegr)
}
}
}
mfx$discretechgvar = ifelse(rownames(mfx) %in% disch, 1, 0)
output = list(fit=fit, mfx=mfx)
return(output)
}
logitMfxSurv <-
function(formula,
design,
atmean = TRUE,
robust = FALSE,
clustervar1 = NULL,
clustervar2 = NULL,
start = NULL
#           control = list() # this option is found in original mfx package
)
{
#    res = logitMfxEstSurv(formula, design, atmean, robust, clustervar1, clustervar2, start, control)
res = logitMfxEstSurv(formula, design, atmean, robust, clustervar1, clustervar2, start)
est = NULL
est$mfxest = cbind(dFdx = res$mfx$mfx,
StdErr = res$mfx$se,
z.value = res$mfx$mfx/res$mfx$se,
p.value = 2*pt(-abs(res$mfx$mfx/res$mfx$se), df = Inf))
colnames(est$mfxest) = c("dF/dx","Std. Err.","z","P>|z|")
rownames(est$mfxest) =  rownames(res$mfx)
est$fit = res$fit
est$dcvar = rownames(res$mfx[res$mfx$discretechgvar==1,])
est$call = match.call()
class(est) = "logitmfx"
est
}
logit = svyglm(KvindeAndOpt ~ GnsIndkomst, design=survey.design, family=quasibinomial(link='logit'))
summary(logit)
logitMfxSurv(formula = KvindeAndOpt ~ GnsIndkomst, design = survey.design)
survey.design <- svydesign(
weights = data.2$TotalOpt,
data = data)
install.packages("survey")
library(survey)
library(survey)
logitMfxEstSurv <-
function(formula,
design,
atmean = TRUE,
robust = FALSE,
clustervar1 = NULL,
clustervar2 = NULL,
start = NULL
#           control = list() # this option is found in the original mfx package
){
if(is.null(formula)){
stop("model formula is missing")
}
for( i in 1:length(class(design))){
if(!((class(design)[i] %in% "survey.design2") | (class(design)[i] %in% "survey.design"))){
stop("design arguement must contain survey object")
}
}
# from Fernihough's original mfx function
# I dont think this is needed because the
# regression computed by the survey package should
# take care of stratification and robust SEs
# from the survey info
=======
tweets = trump_tweets_df %>%
select(id, statusSource, text, created) %>%
extract(statusSource,
"source", "Twitter for (.*?)<") %>%
filter(source %in% c("iPhone", "Android"))
library("list")
library("tidyr")
install.packages("list")
library("list")
tweets = trump_tweets_df %>%
select(id, statusSource, text, created) %>%
extract(statusSource,
"source", "Twitter for (.*?)<") %>%
filter(source %in% c("iPhone", "Android"))
>>>>>>> Stashed changes
#
tweets = trump_tweets_df %>%
select(id, statusSource, text, created) %>%
extract(statusSource,
"source", "Twitter for (.*?)<") %>%
filter(source %in% c("iPhone", "Android"))
file = paste0("http://varianceexplained.org/",
"files/",
"trump_tweets_df.rda")
load(url(file))
library("tidyr")
tweets = trump_tweets_df %>%
select(id, statusSource, text, created) %>%
extract(statusSource,
"source", "Twitter for (.*?)<") %>%
filter(source %in% c("iPhone", "Android"))
library(tidyr)
library("tidytext")
library("stringr")
reg = "([^A-Za-z\\d#@']|'(?![A-Za-z\\d#@]))"
tweet_words = tweets %>%
filter(!str_detect(text, '^"')) %>%
mutate(text =
str_replace_all(text,
"https://t.co/[A-Za-z\\d]+|&amp;", "")) %>%
unnest_tokens(word, text, token = "regex",
pattern = reg) %>%
filter(!word %in% stop_words$word,
str_detect(word, "[a-z]"))
file = paste0("http://varianceexplained.org/",
"files/",
"trump_tweets_df.rda")
load(url(file))
View(trump_tweets_df)
library("tidyr")
tweets = trump_tweets_df %>%
select(id, statusSource, text, created) %>%
extract(statusSource,
"source", "Twitter for (.*?)<") %>%
filter(source %in% c("iPhone", "Android"))
library("ggalt", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
library("ggrepel", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
filter(source %in% c("iPhone", "Android"))
"source", "Twitter for (.*?)<") %>%
filter(source %in% c("iPhone", "Android"))
tweets = trump_tweets_df %>%
select(id, statusSource, text, created) %>%
extract(statusSource,
"source", "Twitter for (.*?)<") %>%
filter(source %in% c("iPhone", "Android"))
library("dplyr")
tweets = trump_tweets_df %>%
select(id, statusSource, text, created) %>%
extract(statusSource,
"source", "Twitter for (.*?)<") %>%
filter(source %in% c("iPhone", "Android"))
library("tidytext")
library("stringr")
reg = "([^A-Za-z\\d#@']|'(?![A-Za-z\\d#@]))"
tweet_words = tweets %>%
filter(!str_detect(text, '^"')) %>%
mutate(text =
str_replace_all(text,
"https://t.co/[A-Za-z\\d]+|&amp;", "")) %>%
unnest_tokens(word, text, token = "regex",
pattern = reg) %>%
filter(!word %in% stop_words$word,
str_detect(word, "[a-z]"))
View(tweet_words)
df.tweet = tweet_words %>%
count(word) %>%
arrange(-n) %>%
filter(row_number() <= 10) %>%
ungroup() %>%
mutate(
word = reorder(as.factor(word), n)
)
p = ggplot(df.tweet, aes(x = word,
y = n))
p + geom_bar(stat = "identity") +
coord_flip() +
labs(x = NULL)
android_iphone_ratios = tweet_words %>%
count(word, source) %>%
filter(sum(n) >= 5) %>%
spread(source, n, fill = 0) %>%
ungroup() %>%
mutate_each(funs((. + 1) / sum(. + 1)), -word) %>%
mutate(logratio = log2(Android / iPhone))
View(android_iphone_ratios)
#
df.1 = android_iphone_ratios %>%
arrange(-logratio) %>%
filter(row_number() <= 10) %>%
mutate(device = "Android")
df.2 = android_iphone_ratios %>%
arrange(logratio) %>%
filter(row_number() <= 10) %>%
mutate(device = "iPhone")
df.trump = df.1 %>%
bind_rows(df.2) %>%
mutate(
word = reorder(word, logratio)
)
View(df.trump)
p = ggplot(df.trump,
aes(x = word, y = logratio,
fill = device))
p + geom_bar(stat = "identity", color = "black") +
coord_flip() + scale_fill_viridis(discrete = TRUE) +
theme(legend.position = "below") +
labs(x = NULL, y = NULL)
library("viridis")
p = ggplot(df.trump,
aes(x = word, y = logratio,
fill = device))
p + geom_bar(stat = "identity", color = "black") +
coord_flip() + scale_fill_viridis(discrete = TRUE) +
theme(legend.position = "below") +
labs(x = NULL, y = NULL)
nrc = sentiments %>%
filter(lexicon == "nrc") %>%
select(word, sentiment)
View(nrc)
p = android_iphone_ratios %>%
inner_join(nrc, by = "word") %>%
filter(!sentiment %in% c("positive", "negative")) %>%
mutate(sentiment = reorder(sentiment, -logratio),
word = reorder(word, -logratio)) %>%
group_by(sentiment) %>%
top_n(10, abs(logratio)) %>%
ungroup() %>%
ggplot(aes(word, logratio, fill = logratio < 0)) +
facet_wrap(~ sentiment, scales = "free", nrow = 2) +
geom_bar(stat = "identity", color = "black") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(x = "", y = "Android / iPhone log ratio") +
scale_fill_viridis(name = "", labels = c("Android", "iPhone"),
discrete = TRUE)
p
library(viridis)
library(pander)
library(stargazer)
library(dplyr)
library(rio)
library(splitstackshape)
library(tonymisc)
<<<<<<< Updated upstream
modw<-glm(KvindeAndOpt ~ GnsIndkomst, family=binomial(link=logit), x=TRUE)
logit1 <- mfx_me(modw) ## Create "mfx" object to trick mtable()
mtable(modw, logit1) ## produces a table with nice output
?glm
>>>>>>> origin/master
=======
library(memisc)
library(grid)
library(gridExtra)
library(tidyr)
library(ggplot2)
library(magrittr)
library(rpart.plot)
library(rpart)
library(viridis)
library(dplyr)
library(rio)
library(grid)
library(gridExtra)
library(tidyr)
library(ggplot2)
library(magrittr)
setwd("~/Desktop/gruppe4")
data <- import("optagelse3.csv") # l??ser csv-filen
lon <- import("londata.csv") # l??ser csv-filen
data <- data %>%
mutate(Kvotient = as.numeric(gsub(",",".",data$Kvotient))) %>%
filter(!is.na(AngMaend) | !is.na(AngKvinder) )
data.1 <- data %>%
mutate(OptMK = round(OptMaend / OptKvinder,2),
TotalOpt = OptMaend + OptKvinder,
TotalAng =AngMaend + AngKvinder,
AngMK = round(AngMaend / AngKvinder,2),
KvindeAndOpt = round(OptKvinder / TotalOpt, 2),
KvindeAndAng = round(AngKvinder / TotalAng, 2))
data.2 <- data.1 %>% left_join(lon, by = "Placering")
data3 <-  data.2 %>%
filter(!is.na(GnsIndkomst)) %>%
mutate(GnsIndT = GnsIndkomst/100000
)
Uni.2 = data3 %>%
group_by(InstNavn) %>%
summarise(Mænd =sum(round(AngMaend/4,0), na.rm =TRUE), Kvinder =sum(round(AngKvinder/4,0), na.rm=TRUE))
Uni.2gather = Uni.2 %>%
gather(key = Køn,
value = frequency,
-InstNavn)
ggplot(data=Uni.2gather, aes(x=reorder(InstNavn, frequency), y=frequency, fill=Køn)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Antal") + xlab("") +
scale_fill_brewer(palette = "Dark2") +  theme_minimal() + theme(axis.title=element_text(size=7), axis.text.y = element_text(size=7), axis.text.x = element_text(size=7))
Uni.3 = data3 %>%
group_by(GnsIndkomst, Uddannelse) %>%
summarise(Mænd =sum(round(AngMaend/4,0), na.rm =TRUE), Kvinder =sum(round(AngKvinder/4,0), na.rm=TRUE))
Uni.3 = Uni.3 %>%
arrange(desc(GnsIndkomst)) %>%
head(n=10)
Uni.3gather = Uni.3 %>%
gather(key = Køn,
value = frequency,
-GnsIndkomst, - Uddannelse)
ggplot(data=Uni.3gather, aes(x=reorder(GnsIndkomst, Uddannelse), y=frequency, fill=Køn)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Antal") + xlab("") +
scale_x_discrete(breaks=c("801156", "805757", "809791", "847594", "849602", "853619", "909823", "926244", "1052373", "1180098"),
labels=c("Civil.ing.kemi, 801.156", "Civil.ing.elektro, 805.757", "Cand.oecon, 809.791", "Erhvervsøkonomi mat, 847.594",
"Jura, 849.602", "Civil.ing.maskin, 853.619", "Matematikøkonomi, 909.823", "Læge , 926.244",
"Cand.polit, 1.052.372", "Forsikringsmatematik, 1.180.098")) +
scale_fill_brewer(palette = "Dark2") +  theme_minimal() + theme(axis.title=element_text(size=7), axis.text.y = element_text(size=7), axis.text.x = element_text(size=7))
Uni.4 = data3 %>%
group_by(OptNr) %>%
summarise(Mænd =sum(round(AngMaend/4,0), na.rm =TRUE), Kvinder =sum(round(AngKvinder/4,0), na.rm=TRUE), Kvotient=mean(Kvotient))
Uni.4 = Uni.4 %>%
arrange(desc(Kvotient)) %>%
head(n=10)
Uni.4gather = Uni.4 %>%
gather(key = Køn,
value = frequency,
-Kvotient, - OptNr)
ggplot(data=Uni.4gather, aes(x=reorder(Kvotient, Køn), y=frequency, fill=Køn)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Antal") + xlab("") +
scale_x_discrete(breaks=c("10.825", "10.85", "10.975", "11", "11.05", "11.15", "11.375", "11.675", "11.95", "12.125"),
labels=c("Statskundskab, KU, 10.83", "Medicin, AU, 10.85", "Antropologi, KU, 10.98", "Internation Shipping and Trade, CBS, 11.00",
"Erhvervsøkonomi Projektledelse, CBS, 11.05", "Medicin, KU, 11.15 ", "Psykologi, KU, 11.38", "International Business and Politics, CBS, 11.68",
"Molekylærbiomedicin, KU, 11.95", "International Business, CBS, 12.13")) +
scale_fill_brewer(palette = "Dark2") +  theme_minimal() + theme(axis.title=element_text(size=7), axis.text.y = element_text(size=7), axis.text.x = element_text(size=7))
#Plot af køn og kvotienter
Uni.4 = data3 %>%
group_by(OptNr) %>%
summarise(Mænd =sum(round(AngMaend/4,0), na.rm =TRUE), Kvinder =sum(round(AngKvinder/4,0), na.rm=TRUE), Kvotient=mean(Kvotient))
Uni.4 = Uni.4 %>%
arrange(desc(Kvotient)) %>%
head(n=10)
Uni.4gather = Uni.4 %>%
gather(key = Køn,
value = frequency,
-Kvotient, - OptNr)
ggplot(data=Uni.4gather, aes(x=reorder(Kvotient, Køn), y=frequency, fill=Køn)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Antal") + xlab("") +
scale_x_discrete(breaks=c("10.825", "10.85", "10.975", "11", "11.05", "11.15", "11.375", "11.675", "11.95", "12.125"),
labels=c("Statskundskab, KU, 10.83", "Medicin, AU, 10.85", "Antropologi, KU, 10.98", "Internation Shipping and Trade, CBS, 11.00",
"Erhvervsøkonomi Projektledelse, CBS, 11.05", "Medicin, KU, 11.15 ", "Psykologi, KU, 11.38", "International Business and Politics, CBS, 11.68",
"Molekylærbiomedicin, KU, 11.95", "International Business, CBS, 12.13")) +
scale_fill_brewer(palette = "Dark2") +  theme_minimal() + theme(axis.title=element_text(size=7), axis.text.y = element_text(size=7), axis.text.x = element_text(size=7))
#Top 10 for mænd
Uni.5 = data3 %>%
group_by(OptNr, Uddannelse) %>%
summarise(Mænd =sum(round(AngMaend/4,0), na.rm =TRUE))
Uni.5 = Uni.5 %>%
arrange(desc(Mænd)) %>%
head(n=10)
Uni.5$OptNr = factor(Uni.5$OptNr)
Maend <- ggplot(data=Uni.5, aes(x=reorder(OptNr, Mænd), y= Mænd)) +  geom_bar(stat="identity", , fill = "#D95F02") +
#geom_point() +
coord_flip() + ylab("Antal") + xlab("") +
scale_x_discrete(breaks=c("13045", "22415", "30010", "17115", "22010", "13060", "22610", "10110", "10410", "13010"),
labels=c("HA Projektledelse, CBS", "Jura, AU", "Arkitekt", "Læge, SDU", "Læge, AU",
"International Business, CBS", "HA, AU", "Læge, KU", "Jura, KU", "HA, CBS")) +  theme_minimal() + theme(axis.title=element_text(size=20), axis.text.y = element_text(size=15), axis.text.x = element_text(size=20))
#Top 10 for kvinder
Uni.6 = data3 %>%
group_by(OptNr, Uddannelse) %>%
summarise (Kvinder =sum(round(AngKvinder/4,0), na.rm=TRUE))
Uni.6 = Uni.6 %>%
arrange(desc(Kvinder)) %>%
head(n=10)
Uni.6$OptNr = factor(Uni.6$OptNr)
Kvinder <- ggplot(data=Uni.6, aes(x=reorder(OptNr, Kvinder), y= Kvinder)) + geom_bar(stat="identity", fill = "#1B9E77") +
coord_flip() + ylab("Antal") + xlab("") +
scale_x_discrete(breaks=c("22415", "16020", "22420", "17115", "10140", "22010", "32010", "10410", "10368", "10110"),
labels=c("Jura, AU", "Human/teologi, RUC", "Psykologi, AU", "Læge, SDU", "Veterinærmedicin, KU", "Læge, AU",
"Designer Unika Design", "Jura, KU", "Psykologi, KU", "Læge, KU")) +  theme_minimal() + theme(axis.title=element_text(size=20), axis.text.y = element_text(size=15),
axis.text.x = element_text(size=20))
grid.arrange(Maend, Kvinder, ncol=2)
Uni.7 = data3 %>%
group_by(Retning) %>%
summarise(Mænd =sum(round(AngMaend/4,0), na.rm =TRUE), Kvinder =sum(round(AngKvinder/4,0), na.rm=TRUE))
Uni.7gather = Uni.7 %>%
gather(key = Køn,
value = frequency,
-Retning)
ggplot(data=Uni.2gather, aes(x=reorder(Retning, frequency), y=frequency, fill=Køn)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Antal") + xlab("") +
scale_fill_brewer(palette = "Dark2") +  theme_minimal() + theme(axis.title=element_text(size=7), axis.text.y = element_text(size=7), axis.text.x = element_text(size=7))
View(Uni.7gather)
Uni.7 = data3 %>%
group_by(Retning) %>%
summarise(Mænd =sum(round(AngMaend/4,0), na.rm =TRUE), Kvinder =sum(round(AngKvinder/4,0), na.rm=TRUE))
Uni.7gather = Uni.7 %>%
gather(key = Køn,
value = frequency,
-Retning)
ggplot(data=Uni.7gather, aes(x=reorder(Retning, frequency), y=frequency, fill=Køn)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Antal") + xlab("") +
scale_fill_brewer(palette = "Dark2") +  theme_minimal() + theme(axis.title=element_text(size=7), axis.text.y = element_text(size=7), axis.text.x = element_text(size=7))
institution = ggplot(data=Uni.2gather, aes(x=reorder(InstNavn, frequency), y=frequency, fill=Køn)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Antal") + xlab("") +
scale_fill_brewer(palette = "Dark2") +  theme_minimal() + theme(axis.title=element_text(size=7), axis.text.y = element_text(size=7), axis.text.x = element_text(size=7))
retning = ggplot(data=Uni.7gather, aes(x=reorder(Retning, frequency), y=frequency, fill=Køn)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Antal") + xlab("") +
scale_fill_brewer(palette = "Dark2") +  theme_minimal() + theme(axis.title=element_text(size=7), axis.text.y = element_text(size=7), axis.text.x = element_text(size=7))
grid.arrange(institution, retning, ncol=2)
indkomst = ggplot(data=Uni.3gather, aes(x=reorder(GnsIndkomst, Uddannelse), y=frequency, fill=Køn)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Antal") + xlab("") +
scale_x_discrete(breaks=c("801156", "805757", "809791", "847594", "849602", "853619", "909823", "926244", "1052373", "1180098"),
labels=c("Civil.ing.kemi, 801.156", "Civil.ing.elektro, 805.757", "Cand.oecon, 809.791", "Erhvervsøkonomi mat, 847.594",
"Jura, 849.602", "Civil.ing.maskin, 853.619", "Matematikøkonomi, 909.823", "Læge , 926.244",
"Cand.polit, 1.052.372", "Forsikringsmatematik, 1.180.098")) +
scale_fill_brewer(palette = "Dark2") +  theme_minimal() + theme(axis.title=element_text(size=7), axis.text.y = element_text(size=7), axis.text.x = element_text(size=7))
Uni.4 = data3 %>%
group_by(OptNr) %>%
summarise(Mænd =sum(round(AngMaend/4,0), na.rm =TRUE), Kvinder =sum(round(AngKvinder/4,0), na.rm=TRUE), Kvotient=mean(Kvotient))
Uni.4 = Uni.4 %>%
arrange(desc(Kvotient)) %>%
head(n=10)
Uni.4gather = Uni.4 %>%
gather(key = Køn,
value = frequency,
-Kvotient, - OptNr)
ggplot(data=Uni.4gather, aes(x=reorder(Kvotient, Køn), y=frequency, fill=Køn)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Antal") + xlab("") +
scale_x_discrete(breaks=c("10.825", "10.85", "10.975", "11", "11.05", "11.15", "11.375", "11.675", "11.95", "12.125"),
labels=c("Statskundskab, KU, 10.83", "Medicin, AU, 10.85", "Antropologi, KU, 10.98", "Internation Shipping and Trade, CBS, 11.00",
"Erhvervsøkonomi Projektledelse, CBS, 11.05", "Medicin, KU, 11.15 ", "Psykologi, KU, 11.38", "International Business and Politics, CBS, 11.68",
"Molekylærbiomedicin, KU, 11.95", "International Business, CBS, 12.13")) +
scale_fill_brewer(palette = "Dark2") +  theme_minimal() + theme(axis.title=element_text(size=7), axis.text.y = element_text(size=7), axis.text.x = element_text(size=7))
kvotient = ggplot(data=Uni.4gather, aes(x=reorder(Kvotient, Køn), y=frequency, fill=Køn)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Antal") + xlab("") +
scale_x_discrete(breaks=c("10.825", "10.85", "10.975", "11", "11.05", "11.15", "11.375", "11.675", "11.95", "12.125"),
labels=c("Statskundskab, KU, 10.83", "Medicin, AU, 10.85", "Antropologi, KU, 10.98", "Internation Shipping and Trade, CBS, 11.00",
"Erhvervsøkonomi Projektledelse, CBS, 11.05", "Medicin, KU, 11.15 ", "Psykologi, KU, 11.38", "International Business and Politics, CBS, 11.68",
"Molekylærbiomedicin, KU, 11.95", "International Business, CBS, 12.13")) +
scale_fill_brewer(palette = "Dark2") +  theme_minimal() + theme(axis.title=element_text(size=7), axis.text.y = element_text(size=7), axis.text.x = element_text(size=7))
grid.arrange(indkomst, kvotient, ncol=2)
setwd("~/Desktop/gruppe4")
data <- import("optagelse3.csv") # l??ser csv-filen
lon <- import("londata.csv") # l??ser csv-filen
data <- data %>%
mutate(Kvotient = as.numeric(gsub(",",".",data$Kvotient))) %>%
filter(!is.na(AngMaend) | !is.na(AngKvinder) )
data.1 <- data %>%
mutate(OptMK = round(OptMaend / OptKvinder,2),
TotalOpt = OptMaend + OptKvinder,
TotalAng =AngMaend + AngKvinder,
AngMK = round(AngMaend / AngKvinder,2),
KvindeAndOpt = round(OptKvinder / TotalOpt, 2),
KvindeAndAng = round(AngKvinder / TotalAng, 2))
data.2 <- data.1 %>% left_join(lon, by = "Placering")
data3 <-  data.2 %>%
filter(!is.na(GnsIndkomst)) %>%
mutate(GnsIndT = GnsIndkomst/100000
)
#Plot af køn på institutioner
Uni.2 = data3 %>%
group_by(InstNavn) %>%
summarise(Mænd =sum(round(AngMaend/4,0), na.rm =TRUE), Kvinder =sum(round(AngKvinder/4,0), na.rm=TRUE))
Uni.2gather = Uni.2 %>%
gather(key = Køn,
value = frequency,
-InstNavn)
institution = ggplot(data=Uni.2gather, aes(x=reorder(InstNavn, frequency), y=frequency, fill=Køn)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Antal") + xlab("") +
scale_fill_brewer(palette = "Dark2") +  theme_minimal() + theme(axis.title=element_text(size=20), axis.text.y = element_text(size=15),
axis.text.x = element_text(size=20))
#Plot af køn og retninger på retninger på uddannelser
Uni.7 = data3 %>%
group_by(Retning) %>%
summarise(Mænd =sum(round(AngMaend/4,0), na.rm =TRUE), Kvinder =sum(round(AngKvinder/4,0), na.rm=TRUE))
Uni.7gather = Uni.7 %>%
gather(key = Køn,
value = frequency,
-Retning)
retning = ggplot(data=Uni.7gather, aes(x=reorder(Retning, frequency), y=frequency, fill=Køn)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Antal") + xlab("") +
scale_fill_brewer(palette = "Dark2") +  theme_minimal() + theme(axis.title=element_text(size=20), axis.text.y = element_text(size=15),
axis.text.x = element_text(size=20))
# Samler de to ovenstående plots
grid.arrange(institution, retning, ncol=2)
setwd("~/Desktop/gruppe4")
data = import("optagelse3.csv") # l??ser csv-filen
lon = import("londata.csv") # l??ser csv-filen
data = read_csv("optagelse3.csv", sep ";") # l??ser csv-filen
lon = read_csv("londata.csv", sep ";") # l??ser csv-filen
library("memoise", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
library("plyr", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
library("readr", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
data = import("optagelse3.csv" # l??ser csv-filen
lon = import("londata1.csv") # l??ser csv-filen
data = import("optagelse3.csv") # l??ser csv-filen
lon = import("londata1.csv") # l??ser csv-filen
library("rmarkdown", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
library("stringr", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
library("purrr", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
library("ggrepel", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
library("ggalt", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
data = import("optagelse3.csv") # l??ser csv-filen
lon = import("londata1.csv") # l??ser csv-filen
data <- data %>%
mutate(Kvotient = as.numeric(gsub(",",".",data$Kvotient))) %>%
filter(!is.na(AngMaend) | !is.na(AngKvinder) )
data.1 <- data %>%
mutate(OptMK = round(OptMaend / OptKvinder,2),
TotalOpt = OptMaend + OptKvinder,
TotalAng =AngMaend + AngKvinder,
AngMK = round(AngMaend / AngKvinder,2),
KvindeAndOpt = round(OptKvinder / TotalOpt, 2),
KvindeAndAng = round(AngKvinder / TotalAng, 2))
data.2 <- data.1 %>% left_join(lon, by = "Placering")
data3 <-  data.2 %>%
filter(!is.na(GnsIndkomst)) %>%
mutate(GnsIndT = GnsIndkomst/100000
)
Uni.2 = data3 %>%
group_by(InstNavn) %>%
summarise(Mænd =sum(round(AngMaend/4,0), na.rm =TRUE), Kvinder =sum(round(AngKvinder/4,0), na.rm=TRUE))
Uni.2gather = Uni.2 %>%
gather(key = Køn,
value = frequency,
-InstNavn)
institution = ggplot(data=Uni.2gather, aes(x=reorder(InstNavn, frequency), y=frequency, fill=Køn)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Antal") + xlab("") +
scale_fill_brewer(palette = "Dark2") +  theme_minimal() + theme(axis.title=element_text(size=20), axis.text.y = element_text(size=15),
axis.text.x = element_text(size=20))
Uni.7 = data3 %>%
group_by(Retning) %>%
summarise(Mænd =sum(round(AngMaend/4,0), na.rm =TRUE), Kvinder =sum(round(AngKvinder/4,0), na.rm=TRUE))
Uni.7gather = Uni.7 %>%
gather(key = Køn,
value = frequency,
-Retning)
retning = ggplot(data=Uni.7gather, aes(x=reorder(Retning, frequency), y=frequency, fill=Køn)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Antal") + xlab("") +
scale_fill_brewer(palette = "Dark2") +  theme_minimal() + theme(axis.title=element_text(size=20), axis.text.y = element_text(size=15),
axis.text.x = element_text(size=20))
grid.arrange(institution, retning, ncol=2)
Uni.7 = data3 %>%
group_by(Retning) %>%
summarise(Mænd =sum(round(AngMaend/4,0), na.rm =TRUE), Kvinder =sum(round(AngKvinder/4,0), na.rm=TRUE))
Uni.7gather = Uni.7 %>%
gather(key = Køn,
value = frequency,
-Retning)
View(Uni.7gather)
View(Uni.7)
Uni.7 = data3 %>%
group_by(Retning) %>%
summarise(Mænd =sum(round(AngMaend/4,0), na.rm =TRUE), Kvinder =sum(round(AngKvinder/4,0), na.rm=TRUE))
Uni.7gather = Uni.7 %>%
gather(key = Køn,
value = frequency,
-Retning)
retning = ggplot(data=Uni.7gather, aes(x=reorder(Retning, frequency), y=frequency, fill=Køn)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Antal") + xlab("") +
scale_fill_brewer(palette = "Dark2") +  theme_minimal() + theme(axis.title=element_text(size=20), axis.text.y = element_text(size=15),
axis.text.x = element_text(size=20))
Uni.7 = data3 %>%
group_by(Retning) %>%
summarise(Mænd =sum(round(AngMaend/4,0), na.rm =TRUE), Kvinder =sum(round(AngKvinder/4,0), na.rm=TRUE))
Uni.7 = data3 %>%
group_by(Retning, OptNr) %>%
summarise(Mænd =sum(round(AngMaend/4,0), na.rm =TRUE), Kvinder =sum(round(AngKvinder/4,0), na.rm=TRUE))
View(Uni.7)
Uni.7 = data3 %>%
group_by(Retning, OptNr) %>%
summarise(Mænd =sum(round(AngMaend/4,0), na.rm =TRUE), Kvinder =sum(round(AngKvinder/4,0), na.rm=TRUE), Retning=sum(round(Retning/4,0), na.rm=TRUE))
Uni.2 = data3 %>%
group_by(InstNavn) %>%
summarise(Mænd =sum(round(AngMaend/4,0), na.rm =TRUE), Kvinder =sum(round(AngKvinder/4,0), na.rm=TRUE))
Uni.2gather = Uni.2 %>%
gather(key = Køn,
value = frequency,
-InstNavn)
institution = ggplot(data=Uni.2gather, aes(x=reorder(InstNavn, frequency), y=frequency, fill=Køn)) +
geom_bar(stat="identity") +
coord_flip() + ylab("Antal") + xlab("") +
scale_fill_brewer(palette = "Dark2") +  theme_minimal() + theme(axis.title=element_text(size=20), axis.text.y = element_text(size=15),
axis.text.x = element_text(size=20))
View(Uni.2gather)
Uni.7 = data3 %>%
group_by(Retning, OptNr) %>%
summarise(Mænd =sum(round(AngMaend/4,0), na.rm =TRUE), Kvinder =sum(round(AngKvinder/4,0), na.rm=TRUE))
Uni.7 = data3 %>%
group_by(Retning) %>%
summarise(Mænd =sum(round(AngMaend/4,0), na.rm =TRUE), Kvinder =sum(round(AngKvinder/4,0), na.rm=TRUE))
>>>>>>> Stashed changes
